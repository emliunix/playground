# WINDOWS DEVELOPMENT

主要是因为要实现一个带蓝牙功能(扫描蓝牙设备，连接蓝牙设备，消息传送)的一个windows程序，
原本想只用C#实现，但是C#木有蓝牙功能。

## 蓝牙支持现状

蓝牙支持现在，嗯，比较混乱，有各种各样的实现栈，虽然有包装好的第三方组件，
但是不是要钱就是太旧。现在不管其他的实现，只关注MS的蓝牙实现。

## MS蓝牙功能

MS蓝牙现在找到的相关资料，详见
[msdn 文档](https://msdn.microsoft.com/en-us/library/windows/desktop/aa363058(v=vs.85).aspx)

## VC++编程技术选型

### 传统动态链接库 p/invoke

实现起来比较方便，但是开发过程不能直接就在VS中添加C#项目到DLL项目的引用。
需要在C#中通过DLLImport来把这个文件中的函数导入到C#项目中，大概就是DLL项目
生成的dll文件需要手动拷贝到C#项目的生成目录下。还有一个问题既是在C++中广泛使用的
结构体如何传递。

### C++/CLI

这种类型的项目就是基于CLR的C++项目，在这种项目中，因为利用到了CLR，语法，库等编程
风格方式上有极大不同，而且在实际的测试中发现如果直接将WinSock相关的头文件引入会造成
大面积出错，这样子导致没有办法直接使用头文件中给出的结构体与函数。
但是优点既是用这种方式生成的DLL可以直接被C#项目引用。

### 小结

现在大概要了解的实现细节既是如何处理结构体，数组等复杂类型在C#和C++原生代码之间的
传递。
